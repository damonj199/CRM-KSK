services:
  api:
    image: ${DOCKER_REGISTRY-}webapi-crm-ksk
    restart: unless-stopped 
    build:
      context: .
      dockerfile: src/CRM-KSK.Api/Dockerfile
    ports:
    - "5000:5000"
    environment:
      ASPNETCORE_URLS: ${ASPNETCORE_URLS}
      ConnectionStrings__DefaultConnection: ${POSTGRES_CONNECTION}
      ASPNETCORE_ENVIRONMENT: Production 
    volumes:
      - /var/log/crm-ksk/api/:/var/log/crm-ksk/api/ 
    networks:
    - crm-network
    
     
  blazor:
    image: ${DOCKER_REGISTRY-}blazor-webassembly-docker
    restart: unless-stopped 
    build:
      context: .
      dockerfile: src/CRM-KSK.Blazor/Dockerfile
    ports:
    - "8080:80"
    depends_on:
    - api
    networks:
    - crm-network
 
networks:
  crm-network:
    driver: bridge